<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Calendario de Cartas</title>
  <link href="https://fonts.googleapis.com/css2?family=Great+Vibes&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <h1>Calendario de Cartas</h1>
 

  <div class="grid" id="cartasGrid">
    <!-- Las cartas se generan con JS -->
  </div>

  <!-- Plantilla de hoja -->
  <div class="hoja" id="hojaCarta">
    <span class="cerrar" id="cerrarHoja">✖</span>
    <input type="text" placeholder="Para: (nombre del destinatario)">
    <textarea placeholder="Escribe tu carta aquí..." style="font-family: Arial, Helvetica, sans-serif; font-size: 15px;"></textarea>
    <button id="descargarCarta" style="font-family: 'Franklin Gothic Medium', 'Arial Narrow', Arial, sans-serif;">Exportar carta a PDF</button>
  </div>

  <script>
  

  const grid = document.getElementById("cartasGrid");
const hoja = document.getElementById("hojaCarta");
const cerrarBtn = document.getElementById("cerrarHoja");

const inputPara = hoja.querySelector("input");
const textareaMensaje = hoja.querySelector("textarea");

let cartaActual = null;

// Crear las 30 cartas
for (let i = 1; i <= 30; i++) {
  const carta = document.createElement("div");
  carta.classList.add("carta");
  carta.textContent = i;
  carta.dataset.dia = i;

  carta.addEventListener("click", () => {
    cartaActual = i;
    abrirHoja(i);
  });

  grid.appendChild(carta);
}

cerrarBtn.addEventListener("click", () => {
  hoja.style.display = "none";
  cartaActual = null;
});

// Guardar cambios al escribir
inputPara.addEventListener("input", guardarDatos);
textareaMensaje.addEventListener("input", guardarDatos);

function abrirHoja(dia) {
  // Cargar datos desde localStorage
  const datos = JSON.parse(localStorage.getItem("carta-" + dia)) || {
    para: "",
    mensaje: ""
  };
  inputPara.value = datos.para;
  textareaMensaje.value = datos.mensaje;
  hoja.style.display = "block";
}

function guardarDatos() {
  if (cartaActual === null) return;
  const datos = {
    para: inputPara.value,
    mensaje: textareaMensaje.value
  };
  localStorage.setItem("carta-" + cartaActual, JSON.stringify(datos));
}







const btnDescargar = document.getElementById("descargarCarta");

btnDescargar.addEventListener("click", () => {
  if (cartaActual === null) return;

  const { jsPDF } = window.jspdf;
  const doc = new jsPDF();

  const datos = JSON.parse(localStorage.getItem("carta-" + cartaActual)) || {
    para: "",
    mensaje: ""
  };

  // Crear el PDF con solo esta carta
  doc.setFont("helvetica", "bold");
  doc.setFontSize(16);
  doc.text(`Carta del Día ${cartaActual}`, 10, 20);

  doc.setFont("helvetica", "normal");
  doc.setFontSize(14);
  doc.text(`Para: ${datos.para || "Sin destinatario"}`, 10, 30);

  const mensaje = doc.splitTextToSize(`Mensaje: ${datos.mensaje || "Sin mensaje"}`, 180);
  doc.text(mensaje, 10, 40);

  doc.save(`Carta-Dia-${cartaActual}.pdf`);
});




  </script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

</body>
</html>
